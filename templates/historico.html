{% extends "base.html" %}
{% block content %}

<main class="container historico-page">

  <h1>üìú Hist√≥rico de Altera√ß√µes</h1>
  <p class="descricao">
    Acompanhe todas as mudan√ßas de status registradas.
  </p>

  {% if equipamento_id %}
  <a href="/historico" class="btn-voltar">‚¨ÖÔ∏è Ver todos</a>
  {% endif %}
<form method="get" class="filtros-form">
  <div class="filtro-campo">
    <label for="data_inicial">Data inicial</label>
    <input type="date" id="data_inicial" name="data_inicial">
  </div>

  <div class="filtro-campo">
    <label for="data_final">Data final</label>
    <input type="date" id="data_final" name="data_final">
  </div>

  <div class="filtro-campo">
    <label for="tecnico">T√©cnico</label>
    <select id="tecnico" name="tecnico">
      <option value="">Todos</option>
      {% for tecnico in tecnicos %}
      <option value="{{ tecnico }}">{{ tecnico }}</option>
      {% endfor %}
    </select>
  </div>

  <div class="filtro-campo">
    <label for="tipo">Tipo</label>
    <select id="tipo" name="tipo">
      <option value="">Todos</option>
      {% for tipo in tipos %}
      <option value="{{ tipo }}">{{ tipo }}</option>
      {% endfor %}
    </select>
  </div>

  <button type="submit" class="btn-filtrar">üîç Filtrar</button>
  <a href="/historico" class="btn-limpar">üßπ Limpar</a>
</form>


  <table class="historico-tabela">
    <thead>
      <tr>
        <th>Data</th>
        <th>Equipamento</th>
        <th>Tipo</th>
        <th>Status Anterior</th>
        <th>Status Novo</th>
        <th>T√©cnico</th>
        <th>Observa√ß√£o</th>
      </tr>
    </thead>
    <tbody>
      {% for h in historico %}
      <tr>
        <td>{{ h.data_modificacao.astimezone().strftime("%d/%m/%Y %H:%M") }}</td>
        <td><strong>{{ h.equipamento.nome_equipamento }}</strong></td>
        <td>{{ h.equipamento.tipo }}</td>
        <td class="antigo">{{ h.status_anterior or '‚Äî' }}</td>
        <td class="novo">{{ h.status_novo or '‚Äî' }}</td>
        <td>{{ h.tecnico or '‚Äî' }}</td>
        <td>{{ h.observacao or '' }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

</main>

{% endblock %}
